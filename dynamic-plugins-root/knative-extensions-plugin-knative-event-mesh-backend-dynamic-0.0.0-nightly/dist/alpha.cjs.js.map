{"version":3,"file":"alpha.cjs.js","sources":["../src/module.ts"],"sourcesContent":["import {loggerToWinstonLogger} from '@backstage/backend-common';\nimport {\n    coreServices,\n    createBackendModule,\n} from '@backstage/backend-plugin-api';\nimport {CatalogClient} from \"@backstage/catalog-client\";\nimport {catalogProcessingExtensionPoint} from '@backstage/plugin-catalog-node/alpha';\n\nimport {KnativeEventMeshProcessor, KnativeEventMeshProvider} from './providers';\n\nexport const catalogModuleKnativeEventMesh = createBackendModule({\n    moduleId: 'knative-event-mesh-module',\n    pluginId: 'catalog',\n    register(env) {\n        env.registerInit({\n            deps: {\n                catalog: catalogProcessingExtensionPoint,\n                config: coreServices.rootConfig,\n                logger: coreServices.logger,\n                scheduler: coreServices.scheduler,\n                discovery: coreServices.discovery,\n            },\n            async init({catalog, config, logger, scheduler, discovery}) {\n                const knativeEventMeshProviders = KnativeEventMeshProvider.fromConfig(config, {\n                    logger: loggerToWinstonLogger(logger),\n                    scheduler: scheduler,\n                });\n                catalog.addEntityProvider(knativeEventMeshProviders);\n\n                const catalogApi = new CatalogClient({\n                    discoveryApi: discovery,\n                });\n\n                const knativeEventMeshProcessor = new KnativeEventMeshProcessor(catalogApi, loggerToWinstonLogger(logger));\n                catalog.addProcessor(knativeEventMeshProcessor);\n            },\n        });\n    },\n});\n"],"names":["createBackendModule","catalogProcessingExtensionPoint","coreServices","KnativeEventMeshProvider","loggerToWinstonLogger","CatalogClient","knativeEventMeshProcessor","KnativeEventMeshProcessor"],"mappings":";;;;;;;;;;;;AAUO,MAAM,gCAAgCA,oCAAoB,CAAA;AAAA,EAC7D,QAAU,EAAA,2BAAA;AAAA,EACV,QAAU,EAAA,SAAA;AAAA,EACV,SAAS,GAAK,EAAA;AACV,IAAA,GAAA,CAAI,YAAa,CAAA;AAAA,MACb,IAAM,EAAA;AAAA,QACF,OAAS,EAAAC,qCAAA;AAAA,QACT,QAAQC,6BAAa,CAAA,UAAA;AAAA,QACrB,QAAQA,6BAAa,CAAA,MAAA;AAAA,QACrB,WAAWA,6BAAa,CAAA,SAAA;AAAA,QACxB,WAAWA,6BAAa,CAAA,SAAA;AAAA,OAC5B;AAAA,MACA,MAAM,KAAK,EAAC,OAAA,EAAS,QAAQ,MAAQ,EAAA,SAAA,EAAW,WAAY,EAAA;AACxD,QAAM,MAAA,yBAAA,GAA4BC,kDAAyB,CAAA,UAAA,CAAW,MAAQ,EAAA;AAAA,UAC1E,MAAA,EAAQC,oCAAsB,MAAM,CAAA;AAAA,UACpC,SAAA;AAAA,SACH,CAAA,CAAA;AACD,QAAA,OAAA,CAAQ,kBAAkB,yBAAyB,CAAA,CAAA;AAEnD,QAAM,MAAA,UAAA,GAAa,IAAIC,2BAAc,CAAA;AAAA,UACjC,YAAc,EAAA,SAAA;AAAA,SACjB,CAAA,CAAA;AAED,QAAA,MAAMC,8BAA4B,IAAIC,mDAAA,CAA0B,UAAY,EAAAH,mCAAA,CAAsB,MAAM,CAAC,CAAA,CAAA;AACzG,QAAA,OAAA,CAAQ,aAAaE,2BAAyB,CAAA,CAAA;AAAA,OAClD;AAAA,KACH,CAAA,CAAA;AAAA,GACL;AACJ,CAAC;;;;"}